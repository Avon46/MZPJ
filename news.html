<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="éº»ç…®è¿·ä½ çŸ³é ­é‹">
  <meta name="google-site-verification" content="qo9bYhV0lEi6k5a0TkTNH8Ogq6YgzqhN_m31TvpAGFw" />
  <title>éº»ç…®å¿«è¨Šï½œéº»ç…®è¿·ä½ çŸ³é ­é‹</title>
  <link rel="stylesheet" href="static/css/responsive-typography.css">
  <link rel="stylesheet" href="static/css/style.css">
  <link rel="stylesheet" href="static/css/i18n.css">
</head>
<body>
<header class="header" id="header">
  <!-- ä¸‰æ¬„ä½ˆå±€ï¼šå·¦ LOGOï¼Œä¸­ å°è¦½ï¼Œå³ èªè¨€åˆ‡æ› -->
  
  <!-- å·¦æ¬„ï¼šLOGO -->
  <div class="header__left">
    <div class="header__logo">
      <a href="home.html" class="header__logo-link">
        <picture class="header__logo-picture">
          <!-- æ‰‹æ©Ÿç‰ˆï¼šä½¿ç”¨ç°¡åŒ–ç‰ˆ logo -->
          <source media="(max-width: 575px)" 
                  srcset="static/img/logo/MAZU.webp 1x, static/img/logo/MAZU.webp 2x">
          <!-- å¹³æ¿å’Œæ¡Œæ©Ÿç‰ˆï¼šä½¿ç”¨å®Œæ•´ç‰ˆ logo -->
          <source media="(min-width: 576px)" 
                  srcset="static/img/logo/MAZU.webp 1x, static/img/logo/MAZU.webp 2x">
          <!-- å‚™ç”¨åœ–ç‰‡ -->
          <img src="static/img/logo/MAZU.webp"
               alt="éº»ç…®logo" class="header__logo-img" loading="lazy">
        </picture>
      </a>
    </div>
  </div>

  <!-- ä¸‰ç‹€æ…‹éŸ¿æ‡‰å¼å°è¦½ -->
  <!-- æ¡Œæ©Ÿç‰ˆå°è¦½ (â‰¥1280px) -->
  <nav class="nav--desktop" aria-label="ä¸»è¦å°è¦½">
    <ul class="header__nav-list">
      <li class="header__nav-item"><a href="about.html" class="header__nav-link" data-i18n="nav.about">é—œæ–¼éº»ç…®</a></li>
      <li class="header__nav-item"><a href="menu.html" class="header__nav-link" data-i18n="nav.menu">èœå–®è³‡è¨Š</a></li>
      <li class="header__nav-item"><a href="news.html" class="header__nav-link is-active" data-i18n="nav.news">éº»ç…®å¿«è¨Š</a></li>
      <li class="header__nav-item"><a href="love.html" class="header__nav-link" data-i18n="nav.love">æ„›å¿ƒå…¬ç›Š</a></li>
    </ul>
  </nav>
  
  <!-- å¹³æ¿ç‰ˆå°è¦½ (768px-1279px) -->
  <nav class="nav--tablet" aria-label="ä¸»è¦å°è¦½">
    <ul class="header__nav-list">
      <li class="header__nav-item"><a href="about.html" class="header__nav-link" data-i18n="nav.about">é—œæ–¼éº»ç…®</a></li>
      <li class="header__nav-item"><a href="menu.html" class="header__nav-link" data-i18n="nav.menu">èœå–®è³‡è¨Š</a></li>
      <li class="header__nav-item"><a href="news.html" class="header__nav-link is-active" data-i18n="nav.news">éº»ç…®å¿«è¨Š</a></li>
      <li class="header__nav-item"><a href="love.html" class="header__nav-link" data-i18n="nav.love">æ„›å¿ƒå…¬ç›Š</a></li>
    </ul>
  </nav>

  <!-- å³æ¬„ï¼šæ¼¢å ¡é¸å–® + èªè¨€åˆ‡æ› -->
  <div class="header__right">
    <!-- æ¼¢å ¡é¸å–® (æ‰‹æ©Ÿç‰ˆé¡¯ç¤º) -->
    <button class="header__hamburger" id="hamburger" aria-label="é–‹å•Ÿé¸å–®"
            aria-controls="mobile-drawer" aria-expanded="false" data-i18n-attr="aria-label:common.hamburger">
      <span class="hamburger__line"></span>
      <span class="hamburger__line"></span>
      <span class="hamburger__line"></span>
    </button>

    <!-- èªè¨€åˆ‡æ› -->
    <div class="header__language">
      <div class="lang-dropdown" role="group" aria-label="èªè¨€åˆ‡æ›">
        <button class="lang-dropdown__toggle" aria-haspopup="true" aria-expanded="false">
          <img src="static/img/logo/world.jpg" alt="ä¸–ç•Œåœ–æ¨™" class="header__icon-img" loading="lazy">
          <span class="lang-dropdown__current">ä¸­</span>
        </button>
      <ul class="lang-dropdown__menu" role="menu">
        <li role="none">
          <button class="lang-dropdown__item lang-dropdown__item--active" role="menuitem" lang="zh-Hant" data-lang="zh">
            <span class="lang-dropdown__flag">ğŸ‡¹ğŸ‡¼</span>
            <span class="lang-dropdown__text">ä¸­æ–‡</span>
          </button>
        </li>
        <li role="none">
          <button class="lang-dropdown__item" role="menuitem" lang="en" data-lang="en">
            <span class="lang-dropdown__flag">ğŸ‡ºğŸ‡¸</span>
            <span class="lang-dropdown__text">English</span>
          </button>
        </li>
      </ul>
    </div>
  </div>
</header>

<!-- æ‰‹æ©Ÿç‰ˆæŠ½å±œå°è¦½ -->
<nav class="nav--mobile" id="mobile-drawer" aria-hidden="true" aria-label="æ‰‹æ©Ÿç‰ˆä¸»è¦å°è¦½">
  <!-- 1. æ¨™é ­å€åŸŸ -->
  <div class="drawer-header">
    <div class="drawer-brand">
      <a href="home.html" class="drawer-logo" aria-label="å›åˆ°é¦–é ">
        <picture>
          <source srcset="static/img/logo/MAZU.webp" type="image/webp">
          <img src="static/img/logo/MAZU.webp" alt="éº»ç…®MINIçŸ³é ­ç«é‹" class="drawer-logo-img">
        </picture>
      </a>
    </div>
    <button class="drawer-close" id="drawer-close" aria-label="é—œé–‰é¸å–®" 
            aria-controls="mobile-drawer" data-i18n-attr="aria-label:common.closeMenu">
      âœ•
    </button>
  </div>

  <!-- 2. ä¸»é¸å–® -->
  <ul class="header__nav-list">
    <li class="header__nav-item"><a href="about.html" class="header__nav-link" data-i18n="nav.about">é—œæ–¼éº»ç…®</a></li>
    <li class="header__nav-item"><a href="menu.html" class="header__nav-link" data-i18n="nav.menu">èœå–®è³‡è¨Š</a></li>
    <li class="header__nav-item"><a href="news.html" class="header__nav-link is-active" data-i18n="nav.news">éº»ç…®å¿«è¨Š</a></li>
    <li class="header__nav-item"><a href="love.html" class="header__nav-link" data-i18n="nav.love">æ„›å¿ƒå…¬ç›Š</a></li>
  </ul>

  <!-- 3. åº•éƒ¨å€åŸŸ -->
  <div class="drawer-footer">
    <!-- èªè¨€åˆ‡æ›åˆ— -->
    <div class="drawer-controls">
      <div class="drawer-language">
        <span class="language-icon">ğŸŒ</span>
        <button class="lang-option active" data-lang="zh" lang="zh">ä¸­</button>
        <span class="lang-separator">|</span>
        <button class="lang-option" data-lang="en" lang="en">EN</button>
      </div>
    </div>

    <!-- ç¤¾ç¾¤åˆ— -->
    <div class="drawer-social">
      <a href="https://www.facebook.com/mazustonehotpot" target="_blank" rel="noopener noreferrer" class="social-link">
        <span class="social-icon">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="#1877F2">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
          </svg>
        </span>
        <span>éº»ç…®FBç²‰çµ²å°ˆé </span>
      </a>

      <a href="https://www.google.com/maps/place/%E9%BA%BB%E7%85%AE%E8%BF%B7%E4%BD%A0%E7%9F%B3%E9%A0%AD%E9%8D%8B+-+%E5%85%AC%E9%A4%A8%E5%BA%97/@25.0124864,121.5329133,17z/data=!3m1!4b1!4m6!3m5!1s0x3442a984ad026c2b:0x13c6677a196768d7!8m2!3d25.0124864!4d121.5354882!16s%2Fg%2F11qs93qvks?entry=ttu&g_ep=EgoyMDI1MDgyNS4wIKXMDSoASAFQAw%3D%3D" target="_blank" rel="noopener noreferrer" class="social-link">
        <span class="social-icon">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C15.87 2 19 5.13 19 9C19 14.25 12 22 12 22S5 14.25 5 9C5 5.13 8.13 2 12 2Z" fill="#EA4335"/>
            <circle cx="12" cy="9" r="2.5" fill="#FFFFFF"/>
          </svg>
        </span>
        <span>100å°åŒ—å¸‚ä¸­æ­£å€æ±€å·è·¯ä¸‰æ®µ273è™Ÿ</span>
      </a>
    </div>

                    <!-- ç‰ˆæ¬Š -->
                <div class="drawer-copyright">
                  Â© Powered and secured by MISS-TEPPAN
                </div>
  </div>
</nav>

<!-- èƒŒæ™¯é®ç½© -->
<div class="backdrop" id="backdrop" aria-hidden="true"></div>

<main class="main">
  <!-- é¦–å±ï¼ˆHeroï¼‰ -->
  <section id="hero" class="hero news-hero">
    <div class="news__banner"></div> <!-- èƒŒæ™¯åœ–è«‹åœ¨ CSS è¨­å®šï¼Œè¦‹ä¸‹æ–¹ -->
    <div class="hero__description news-hero__desc">
      <h1 class="news-hero__title" data-i18n="news.hero.title">éº»ç…®å¿«è¨Š</h1>
      <p class="news-hero__subtitle" data-i18n="news.hero.subtitle">æœ€æ–°æ¶ˆæ¯ãƒ»æ´»å‹•æƒ…å ±ãƒ»å„ªæƒ å…¬å‘Š</p>
      <a href="#latest" class="news-cta" data-i18n="news.hero.cta">æŸ¥çœ‹æœ€æ–°è¨Šæ¯</a>
    </div>
  </section>

  <!-- æœ€æ–°å…¬å‘Š -->
  <section id="latest" class="news-section news-latest">
    <div class="news-section__container">
      <h2 class="news-section__title" data-i18n="news.latest.title">æœ€æ–°è¨Šæ¯</h2>
      <p class="news-section__hint" data-i18n="news.latest.hint">è¿‘æœŸæ¶ˆæ¯å°‡æ›´æ–°æ–¼æ­¤ã€‚</p>

      <div class="news-list" id="news-list">
        <!-- æ–°èå¡ç‰‡å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
      </div>
      
      <!-- åˆ†é å®¹å™¨ -->
      <div id="news-pagination"></div>
    </div>
  </section>

  <!-- æ–°èè©³æƒ…é é¢å®¹å™¨ -->
  <div id="news-detail-view" style="display: none;"></div>
</main>

<!-- å›åˆ°é ‚éƒ¨æŒ‰éˆ• -->
<button class="back-to-top" id="back-to-top" title="å›åˆ°é ‚éƒ¨" data-i18n-attr="title:common.backToTop">â†‘</button>

<footer class="footer">
  <p class="footer__text">Â© Powered and secured by MISS-TEPPAN</p>
</footer>

<!-- æ–°èå‹•æ…‹åŠ è¼‰è…³æœ¬ -->
<script>
  // åˆ†é ç›¸é—œè®Šæ•¸
  let currentPage = 1;
  const itemsPerPage = 6;
  let allNewsData = [];
  
  // åŠ è¼‰æ–°èé é¢å®Œæ•´æ–°èåˆ—è¡¨
  async function loadAllNews() {
    try {
      console.log('é–‹å§‹è¼‰å…¥æ–°èæ•¸æ“š...');
      const response = await fetch('/static/news.json');
      console.log('Response status:', response.status);
      console.log('Response headers:', response.headers);
      
      // æª¢æŸ¥éŸ¿æ‡‰ç‹€æ…‹
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      const data = await response.json();
      console.log('è¼‰å…¥çš„æ–°èæ•¸æ“š:', data);
      console.log('æ•¸æ“šé¡å‹:', typeof data);
      console.log('æ˜¯å¦ç‚ºé™£åˆ—:', Array.isArray(data));
      
      if (!Array.isArray(data)) {
        throw new Error('æ–°èæ•¸æ“šæ ¼å¼éŒ¯èª¤ï¼šä¸æ˜¯é™£åˆ—æ ¼å¼');
      }
      
      if (data.length === 0) {
        throw new Error('æ–°èæ•¸æ“šç‚ºç©º');
      }
      
      allNewsData = data;
      console.log('è¨­ç½® allNewsData æˆåŠŸï¼Œé•·åº¦:', allNewsData.length);
      
      // æŒ‰æ—¥æœŸæ’åºï¼ˆæœ€æ–°åœ¨å‰ï¼‰ï¼Œæ—¥æœŸç›¸åŒæ™‚æŒ‰ id å€’åº
      allNewsData.sort((a, b) => {
        const dateA = new Date(a.date);
        const dateB = new Date(b.date);
        if (dateA.getTime() === dateB.getTime()) {
          return b.id - a.id; // æ—¥æœŸç›¸åŒæ™‚ï¼Œid å¤§çš„åœ¨å‰
        }
        return dateB - dateA; // æ—¥æœŸæ–°çš„åœ¨å‰
      });
      
      console.log('æ’åºå¾Œçš„æ–°èæ•¸æ“š:', allNewsData);
      
      // é¡¯ç¤ºç¬¬ä¸€é 
      displayNewsPage(1);
      
      // å‰µå»ºåˆ†é 
      createPagination();
      
      console.log('æ–°èè¼‰å…¥å’Œé¡¯ç¤ºå®Œæˆ');
      
    } catch (error) {
      console.error('åŠ è¼‰æ–°èæ•¸æ“šå¤±æ•—:', error);
      console.error('éŒ¯èª¤è©³æƒ…:', {
        message: error.message,
        stack: error.stack,
        url: '/static/news.json'
      });
      
      // ç™¼ç”ŸéŒ¯èª¤æ™‚é¡¯ç¤ºé è¨­å…§å®¹
      const newsList = document.getElementById('news-list');
      if (!newsList) {
        console.error('æ‰¾ä¸åˆ° news-list å…ƒç´ ï¼Œç„¡æ³•é¡¯ç¤ºéŒ¯èª¤ä¿¡æ¯');
        return;
      }
      
      // é¡¯ç¤ºæ›´è©³ç´°çš„éŒ¯èª¤ä¿¡æ¯
      newsList.innerHTML = `
        <div style="text-align: center; color: #666; padding: 2rem;">
          <p>è¼‰å…¥æ–°èæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>
          <p style="font-size: 0.9em; margin-top: 1rem;">
            éŒ¯èª¤è©³æƒ…ï¼š${error.message}
          </p>
          <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: var(--color-primary); color: white; border: none; border-radius: 4px; cursor: pointer;">
            é‡æ–°è¼‰å…¥
          </button>
        </div>
      `;
    }
  }
  
  // é¡¯ç¤ºæŒ‡å®šé é¢çš„æ–°è
  function displayNewsPage(page) {
    console.log('é¡¯ç¤ºç¬¬', page, 'é æ–°è');
    console.log('ç•¶å‰æ–°èæ•¸æ“š:', allNewsData);
    
    const newsList = document.getElementById('news-list');
    if (!newsList) {
      console.error('æ‰¾ä¸åˆ° news-list å…ƒç´ ');
      return;
    }
    
    if (!Array.isArray(allNewsData) || allNewsData.length === 0) {
      console.error('æ–°èæ•¸æ“šç‚ºç©ºæˆ–æ ¼å¼éŒ¯èª¤');
      newsList.innerHTML = '<p style="text-align: center; color: #666;">æš«ç„¡æ–°èæ•¸æ“š</p>';
      return;
    }
    
    // æ›´æ–°ç•¶å‰é é¢è®Šæ•¸
    currentPage = page;
    console.log('è¨­ç½®ç•¶å‰é é¢ç‚º:', currentPage);
    
    const startIndex = (page - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;
    const pageNews = allNewsData.slice(startIndex, endIndex);
    
    console.log('ç•¶å‰é é¢æ–°è:', pageNews);
    
    // ç”Ÿæˆæ–°èå¡ç‰‡ HTML
    const newsCardsHTML = pageNews.map(news => `
      <article class="news-card" id="news-${news.id}" data-news-id="${news.id}">
        <div class="news-card__image">
          <img src="${news.image}" alt="${news.title}" loading="lazy">
        </div>
        <div class="news-card__content">
          <h3 class="news-card__title">${news.title}</h3>
          <time class="news-card__time" datetime="${news.date}">${news.date}</time>
        </div>
      </article>
    `).join('');
    
    console.log('ç”Ÿæˆçš„æ–°èå¡ç‰‡ HTML:', newsCardsHTML);
    
    // è¨­ç½® HTML å…§å®¹
    newsList.innerHTML = newsCardsHTML;
    
    // ç‚ºæ¯å€‹æ–°èå¡ç‰‡æ·»åŠ é»æ“Šäº‹ä»¶
    addNewsCardClickEvents();
    
    // æ›´æ–°åˆ†é æŒ‰éˆ•ç‹€æ…‹
    updatePaginationButtons();
  }
  
  // å‰µå»ºåˆ†é æŒ‰éˆ•
  function createPagination() {
    console.log('å‰µå»ºåˆ†é ï¼Œç¸½æ–°èæ•¸:', allNewsData.length);
    
    if (!Array.isArray(allNewsData) || allNewsData.length === 0) {
      console.log('æ–°èæ•¸æ“šç‚ºç©ºï¼Œä¸å‰µå»ºåˆ†é ');
      return;
    }
    
    const totalPages = Math.ceil(allNewsData.length / itemsPerPage);
    console.log('ç¸½é æ•¸:', totalPages);
    
    const paginationContainer = document.getElementById('news-pagination');
    if (!paginationContainer) {
      console.error('æ‰¾ä¸åˆ°åˆ†é å®¹å™¨');
      return;
    }
    
    let paginationHTML = '<div class="news-pagination">';
    
    for (let i = 1; i <= totalPages; i++) {
      paginationHTML += `
        <button class="news-pagination__btn ${i === 1 ? 'is-active' : ''}" 
                onclick="changePage(${i})" data-page="${i}">
          ${i}
        </button>
      `;
    }
    
    paginationHTML += '</div>';
    paginationContainer.innerHTML = paginationHTML;
    console.log('åˆ†é å‰µå»ºå®Œæˆ');
  }
  
  // åˆ‡æ›é é¢
  function changePage(page) {
    displayNewsPage(page);
    
    // æ›´æ–°åˆ†é æŒ‰éˆ•ç‹€æ…‹
    const buttons = document.querySelectorAll('.news-pagination__btn');
    buttons.forEach(btn => {
      btn.classList.remove('is-active');
      if (parseInt(btn.dataset.page) === page) {
        btn.classList.add('is-active');
      }
    });
    
    // æ»¾å‹•åˆ°æœ€æ–°æ¶ˆæ¯å€åŸŸï¼Œè€Œä¸æ˜¯é é¢é ‚éƒ¨
    const latestSection = document.getElementById('latest');
    if (latestSection) {
      latestSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  }
  
  // æ›´æ–°åˆ†é æŒ‰éˆ•ç‹€æ…‹
  function updatePaginationButtons() {
    const buttons = document.querySelectorAll('.news-pagination__btn');
    buttons.forEach(btn => {
      btn.classList.remove('is-active');
      if (parseInt(btn.dataset.page) === currentPage) {
        btn.classList.add('is-active');
      }
    });
  }
  
  // è©³æƒ…æ¨¡å¼å…¨åŸŸè¨­å®š
  const ENABLE_DETAIL = true;
  const DETAIL_MODE = "hash"; // "inline" | "modal" | "hash"
  
  // ç²å–ç•¶å‰æ»¾å‹•ä½ç½®çš„è¼”åŠ©å‡½æ•¸ï¼ˆå…¼å®¹ä¸åŒç€è¦½å™¨ï¼‰
  function getScrollPosition() {
    return window.pageYOffset || 
           document.documentElement.scrollTop || 
           document.body.scrollTop || 
           0;
  }
  
  // é€™äº›å‹•ç•«å‡½æ•¸å·²ä¸å†éœ€è¦ï¼Œä¿ç•™è¨»è§£ä»¥ä¾›åƒè€ƒ
  // function fadeOutListContent(callback) { ... }
  // function fadeInListContent() { ... }
  // function fadeOutDetailContent(callback) { ... }
  // function fadeInDetailContent() { ... }
  // function hideNonDetailContent() { ... }
  // function showAllContent() { ... }
  
  // è©³æƒ…æ¨¡å¼ç›¸é—œè®Šæ•¸
  let currentDetailId = null;
  let detailFromPage = 1; // è¨˜éŒ„ç”¨æˆ¶æ˜¯å¾å“ªä¸€é é€²å…¥è©³æƒ…çš„
  let detailFromNewsId = null; // è¨˜éŒ„ç”¨æˆ¶é»æ“Šçš„æ–°è ID
  let detailFromScrollPosition = 0; // è¨˜éŒ„ç”¨æˆ¶é€²å…¥è©³æƒ…å‰çš„æ»¾å‹•ä½ç½®
  
  // ç‚ºæ–°èå¡ç‰‡æ·»åŠ é»æ“Šäº‹ä»¶
  function addNewsCardClickEvents() {
    const newsCards = document.querySelectorAll('.news-card');
    console.log(`æ‰¾åˆ° ${newsCards.length} å€‹æ–°èå¡ç‰‡ï¼Œé–‹å§‹ç¶å®šé»æ“Šäº‹ä»¶...`);
    
    newsCards.forEach((card, index) => {
      // å…ˆç²å–æ¨™é¡Œæ–‡å­—ï¼Œé¿å… this ç¶å®šå•é¡Œ
      const titleElement = card.querySelector('.news-card__title');
      const titleText = titleElement ? titleElement.textContent : 'æ–°èæ¨™é¡Œ';
      const newsId = parseInt(card.dataset.newsId);
      
      console.log(`ç¶å®šå¡ç‰‡ ${index + 1}: ID=${newsId}, æ¨™é¡Œ="${titleText}"`);
      
      card.addEventListener('click', function() {
        console.log(`é»æ“Šæ–°èå¡ç‰‡ï¼ŒID: ${newsId}`);
        openNewsDetail(newsId);
      });
      
      // éµç›¤æ“ä½œæ”¯æ´
      card.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          console.log(`éµç›¤è§¸ç™¼æ–°èè©³æƒ…ï¼ŒID: ${newsId}`);
          openNewsDetail(newsId);
        }
      });
      
      // è¨­ç½®å¯èšç„¦
      card.setAttribute('tabindex', '0');
      card.setAttribute('role', 'button');
      card.setAttribute('aria-label', `æŸ¥çœ‹ ${titleText} çš„è©³ç´°è³‡è¨Š`);
    });
    
    console.log('æ–°èå¡ç‰‡é»æ“Šäº‹ä»¶ç¶å®šå®Œæˆ');
  }
  
  // é–‹å•Ÿæ–°èè©³æƒ…
  function openNewsDetail(newsId) {
    console.log(`=== é–‹å•Ÿæ–°èè©³æƒ…é–‹å§‹ ===`);
    console.log(`æ–°è ID: ${newsId}, è©³æƒ…æ¨¡å¼: ${DETAIL_MODE}`);
    
    if (!ENABLE_DETAIL) {
      console.error('è©³æƒ…æ¨¡å¼å·²ç¦ç”¨');
      return;
    }
    
    if (!newsId || isNaN(newsId)) {
      console.error('ç„¡æ•ˆçš„æ–°è ID:', newsId);
      return;
    }
    
    currentDetailId = newsId;
    detailFromPage = currentPage; // è¨˜éŒ„ç•¶å‰é é¢
    detailFromNewsId = newsId; // è¨˜éŒ„é»æ“Šçš„æ–°è ID
    detailFromScrollPosition = getScrollPosition(); // è¨˜éŒ„ç•¶å‰æ»¾å‹•ä½ç½®
    
    console.log(`ç”¨æˆ¶å¾ç¬¬ ${detailFromPage} é é€²å…¥è©³æƒ…ï¼Œæ–°è ID: ${newsId}`);
    console.log(`è¨˜éŒ„æ»¾å‹•ä½ç½®: ${detailFromScrollPosition}px`);
    
    // ç™¼é€äº‹ä»¶è¿½è¹¤
    window.dispatchEvent(new CustomEvent('news:open', { 
      detail: { id: newsId, mode: DETAIL_MODE, fromPage: detailFromPage } 
    }));
    
    switch (DETAIL_MODE) {
      case "hash":
        console.log('ä½¿ç”¨ Hash è·¯ç”±æ¨¡å¼');
        openHashDetail(newsId);
        break;
      case "inline":
        console.log('ä½¿ç”¨ Inline æ¨¡å¼');
        openInlineDetail(newsId);
        break;
      case "modal":
        console.log('ä½¿ç”¨ Modal æ¨¡å¼');
        openModalDetail(newsId);
        break;
      default:
        console.error('æœªçŸ¥çš„è©³æƒ…æ¨¡å¼:', DETAIL_MODE);
    }
    
    console.log(`=== é–‹å•Ÿæ–°èè©³æƒ…å®Œæˆ ===`);
  }
  
  // Hash SPA è©³æƒ…æ¨¡å¼
  function openHashDetail(newsId) {
    console.log(`è¨­ç½® Hash è·¯ç”±: #detail/${newsId}`);
    window.location.hash = `detail/${newsId}`;
  }
  
  // Inline å±•é–‹è©³æƒ…æ¨¡å¼
  function openInlineDetail(newsId) {
    // é—œé–‰å…¶ä»–å·²å±•é–‹çš„è©³æƒ…
    const existingDetails = document.querySelectorAll('.news-detail');
    existingDetails.forEach(detail => detail.remove());
    
    const newsCard = document.getElementById(`news-${newsId}`);
    if (!newsCard) return;
    
    const newsData = allNewsData.find(news => news.id === newsId);
    if (!newsData) return;
    
    const detailHTML = createDetailHTML(newsData, "inline");
    newsCard.insertAdjacentHTML('afterend', detailHTML);
    
    // æ»¾å‹•åˆ°è©³æƒ…å€åŸŸ
    const detailElement = document.querySelector('.news-detail');
    if (detailElement) {
      detailElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  }
  
  // Modal å°è©±æ¡†è©³æƒ…æ¨¡å¼
  function openModalDetail(newsId) {
    const newsData = allNewsData.find(news => news.id === newsId);
    if (!newsData) return;
    
    const modalHTML = createDetailHTML(newsData, "modal");
    document.body.insertAdjacentHTML('beforeend', modalHTML);
    
    const modal = document.querySelector('.news-detail-modal');
    const backdrop = document.querySelector('.news-detail-backdrop');
    
    // èšç„¦åˆ°æ¨™é¡Œ
    const title = modal.querySelector('h2');
    if (title) title.focus();
    
    // é—œé–‰äº‹ä»¶
    backdrop.addEventListener('click', closeModal);
    modal.querySelector('.news-detail-close').addEventListener('click', closeModal);
    
    // ESC éµé—œé–‰
    document.addEventListener('keydown', handleModalKeydown);
    
    // é˜²æ­¢èƒŒæ™¯æ»¾å‹•
    document.body.style.overflow = 'hidden';
  }
  
  // å‰µå»ºè©³æƒ… HTML
  function createDetailHTML(newsData, mode) {
    const content = newsData.content || 'é€™å‰‡å¿«è¨Šç›®å‰åƒ…æä¾›æ‘˜è¦ï¼Œå®Œæ•´å…§å®¹å°‡æ–¼è¿‘æœŸæ›´æ–°ã€‚';
    const image = newsData.image || '/static/img/logo/æ–°èå¤§åœ–.jpg';
    
    if (mode === "modal") {
      return `
        <div class="news-detail-backdrop" role="presentation"></div>
        <div class="news-detail-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title-${newsData.id}">
          <button class="news-detail-close" aria-label="é—œé–‰è©³æƒ…">Ã—</button>
          <div class="news-detail-content">
            <h2 id="modal-title-${newsData.id}">${newsData.title}</h2>
            <time class="news-detail-time" datetime="${newsData.date}">${newsData.date}</time>
            <div class="news-detail-image">
              <img src="${image}" alt="${newsData.title}" loading="lazy">
            </div>
            <div class="news-detail-text">
              ${content}
            </div>
          </div>
        </div>
      `;
    } else {
      return `
        <div class="news-detail" id="detail-${newsData.id}">
          <div class="news-detail-content">
            <h2>${newsData.title}</h2>
            <time class="news-detail-time" datetime="${newsData.date}">${newsData.date}</time>
            <div class="news-detail-image">
              <img src="${image}" alt="${newsData.title}" loading="lazy">
            </div>
            <div class="news-detail-text">
              ${content}
            </div>
            <button class="news-detail-close" aria-controls="detail-${newsData.id}">é—œé–‰è©³æƒ…</button>
          </div>
        </div>
      `;
    }
  }
  
  // é—œé–‰ Modal
  function closeModal() {
    const modal = document.querySelector('.news-detail-modal');
    const backdrop = document.querySelector('.news-detail-backdrop');
    
    if (modal) modal.remove();
    if (backdrop) backdrop.remove();
    
    document.body.style.overflow = '';
    document.removeEventListener('keydown', handleModalKeydown);
  }
  
  // è™•ç† Modal éµç›¤äº‹ä»¶
  function handleModalKeydown(e) {
    if (e.key === 'Escape') {
      closeModal();
    }
  }
  
  // è™•ç† Hash è®ŠåŒ–
  function handleHashChange() {
    const hash = window.location.hash;
    console.log(`Hash è®ŠåŒ–: ${hash}`);
    
    if (hash.startsWith('#detail/')) {
      const newsId = parseInt(hash.split('/')[1]);
      console.log(`æª¢æ¸¬åˆ°è©³æƒ… Hashï¼Œæ–°è ID: ${newsId}`);
      showDetailPage(newsId);
    } else {
      // è¿”å›åˆ—è¡¨é é¢
      console.log('Hash è®ŠåŒ–ï¼Œè¿”å›åˆ—è¡¨é é¢');
      showListPage();
    }
  }
  
  // é¡¯ç¤ºè©³æƒ…é é¢
  function showDetailPage(newsId) {
    console.log(`é–‹å§‹é¡¯ç¤ºè©³æƒ…é é¢ï¼Œæ–°è ID: ${newsId}`);
    
    const newsData = allNewsData.find(news => news.id === newsId);
    if (!newsData) {
      console.error(`æ‰¾ä¸åˆ° ID ${newsId} çš„æ–°èæ•¸æ“š`);
      showListPage();
      return;
    }
    
    console.log('æ‰¾åˆ°æ–°èæ•¸æ“š:', newsData);
    
    // éš±è—æ–°èåˆ—è¡¨å€åŸŸ
    const latestSection = document.querySelector('.news-latest');
    if (latestSection) {
      latestSection.style.display = 'none';
      console.log('éš±è—æ–°èåˆ—è¡¨å€åŸŸ');
    }
    
    // é¡¯ç¤ºè©³æƒ…é é¢
    const detailPage = createDetailPageHTML(newsData);
    const detailContainer = document.getElementById('news-detail-view');
    if (detailContainer) {
      detailContainer.innerHTML = detailPage;
      detailContainer.style.display = 'block';
      console.log('è©³æƒ…é é¢ HTML å·²æ’å…¥åˆ°å°ˆç”¨å®¹å™¨');
      
      // ç™¼é€äº‹ä»¶è¿½è¹¤
      window.dispatchEvent(new CustomEvent('news:view', { 
        detail: { id: newsId } 
      }));
      
      // æ›´æ–°é é¢æ¨™é¡Œ
      document.title = `${newsData.title} - éº»ç…®å¿«è¨Š`;
      
      console.log('è©³æƒ…é é¢é¡¯ç¤ºå®Œæˆ');
    } else {
      console.error('æ‰¾ä¸åˆ° #news-detail-view å®¹å™¨');
    }
  }
  
  // é¡¯ç¤ºåˆ—è¡¨é é¢
  function showListPage() {
    console.log('é–‹å§‹é¡¯ç¤ºåˆ—è¡¨é é¢...');
    
    // éš±è—è©³æƒ…é é¢
    const detailContainer = document.getElementById('news-detail-view');
    if (detailContainer) {
      detailContainer.style.display = 'none';
      console.log('éš±è—è©³æƒ…é é¢');
    }
    
    // é¡¯ç¤ºæ–°èåˆ—è¡¨å€åŸŸ
    const latestSection = document.querySelector('.news-latest');
    if (latestSection) {
      latestSection.style.display = 'block';
      console.log('é¡¯ç¤ºæ–°èåˆ—è¡¨å€åŸŸ');
    }
    
    // è¿”å›åˆ°ç”¨æˆ¶ä¹‹å‰çš„åˆ†é 
    if (detailFromPage && detailFromPage !== currentPage) {
      console.log(`è¿”å›ç”¨æˆ¶ä¹‹å‰çš„åˆ†é : ç¬¬ ${detailFromPage} é `);
      displayNewsPage(detailFromPage);
      
      // æ›´æ–°åˆ†é æŒ‰éˆ•ç‹€æ…‹
      const buttons = document.querySelectorAll('.news-pagination__btn');
      buttons.forEach(btn => {
        btn.classList.remove('is-active');
        if (parseInt(btn.dataset.page) === detailFromPage) {
          btn.classList.add('is-active');
        }
      });
    }
    
    // æ¢å¾©æ»¾å‹•ä½ç½®
    if (detailFromScrollPosition > 0) {
      setTimeout(() => {
        console.log(`æ¢å¾©æ»¾å‹•ä½ç½®: ${detailFromScrollPosition}px`);
        window.scrollTo({
          top: detailFromScrollPosition,
          behavior: 'smooth'
        });
      }, 100);
    }
    
    // æ¢å¾©é é¢æ¨™é¡Œ
    document.title = 'éº»ç…®å¿«è¨Š - æœ€æ–°å…¬å‘Š';
    
    console.log('åˆ—è¡¨é é¢é¡¯ç¤ºå®Œæˆ');
  }
  
  // å‰µå»ºè©³æƒ…é é¢ HTML
  function createDetailPageHTML(newsData) {
    const content = newsData.content || 'é€™å‰‡å¿«è¨Šç›®å‰åƒ…æä¾›æ‘˜è¦ï¼Œå®Œæ•´å…§å®¹å°‡æ–¼è¿‘æœŸæ›´æ–°ã€‚';
    const image = newsData.image || '/static/img/logo/æ–°èå¤§åœ–.jpg';
    
    return `
      <div class="news-detail-page">
        <div class="news-detail-page__header">
          <button class="news-back-btn" onclick="goBackToList()" aria-label="è¿”å›æ–°èåˆ—è¡¨">
            â† è¿”å›åˆ—è¡¨
          </button>
        </div>
        <article class="news-detail-page__content">
          <h1 class="news-detail-page__title">${newsData.title}</h1>
          <time class="news-detail-page__time" datetime="${newsData.date}">${newsData.date}</time>
          <div class="news-detail-page__image">
            <img src="${image}" alt="${newsData.title}" loading="lazy">
          </div>
          <div class="news-detail-page__text">
            ${content}
          </div>
        </article>
      </div>
    `;
  }
  
  // è¿”å›åˆ—è¡¨
  function goBackToList() {
    console.log('=== è¿”å›åˆ—è¡¨é é¢é–‹å§‹ ===');
    console.log('ç”¨æˆ¶é»æ“Šè¿”å›æŒ‰éˆ•ï¼Œæ¢å¾©æ»¾å‹•ä½ç½®:', detailFromScrollPosition, 'px');
    
    // ç›´æ¥èª¿ç”¨ showListPage å‡½æ•¸ï¼Œç¢ºä¿ç«‹å³è¿”å›åˆ—è¡¨
    showListPage();
    
    // æ¸…é™¤ hashï¼Œä¿æŒ URL æ•´æ½”
    window.location.hash = '';
    console.log('å·²ç›´æ¥è¿”å›åˆ—è¡¨é é¢');
  }
  
  // é é¢åŠ è¼‰å®Œæˆå¾ŒåŸ·è¡Œ
  document.addEventListener('DOMContentLoaded', function() {
    console.log('=== é é¢åˆå§‹åŒ–é–‹å§‹ ===');
    console.log('DOM åŠ è¼‰å®Œæˆï¼Œé–‹å§‹åˆå§‹åŒ–...');
    
    // æª¢æŸ¥å¿…è¦çš„ DOM å…ƒç´ 
    const newsList = document.getElementById('news-list');
    const pagination = document.getElementById('news-pagination');
    
    console.log('news-list å…ƒç´ :', newsList);
    console.log('news-pagination å…ƒç´ :', pagination);
    
    if (!newsList) {
      console.error('æ‰¾ä¸åˆ° news-list å…ƒç´ ');
      return;
    }
    
    if (!pagination) {
      console.error('æ‰¾ä¸åˆ° news-pagination å…ƒç´ ');
      return;
    }
    
    console.log('DOM å…ƒç´ æª¢æŸ¥å®Œæˆï¼Œé–‹å§‹è¼‰å…¥æ–°è...');
    
    // å»¶é²ä¸€ä¸‹å†è¼‰å…¥æ–°èï¼Œç¢ºä¿é é¢å®Œå…¨æº–å‚™å¥½
    setTimeout(() => {
      console.log('å»¶é²è¼‰å…¥æ–°è...');
      loadAllNews();
    }, 100);
    
    // ç›£è½ hash è®ŠåŒ–
    window.addEventListener('hashchange', handleHashChange);
    
    // åˆå§‹æª¢æŸ¥ hash
    if (window.location.hash) {
      handleHashChange();
    }
    
    console.log('åˆå§‹åŒ–å®Œæˆ');
  });
</script>

  <!-- å¤šèªåˆ‡æ›ç³»çµ± -->
  <script src="static/js/i18n.js"></script>
  
  <!-- JavaScript -->
  <script src="static/js/script.js"></script>
</body>
</html>
